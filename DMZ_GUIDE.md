# DMZ Setup Guide (with Ngrok)

This guide explains how to deploy the **DMZ component** of the SOC Project on an Ubuntu Server and expose it via **Ngrok** for external access.

## 1. Prerequisites
Ensure your Ubuntu server has Docker and Git installed:

```bash
sudo apt update
sudo apt install -y git docker.io docker-compose-v2
```

## 2. Clone the Repository
Clone the project code:

```bash
git clone https://github.com/oussamakou/PI-IR-SOC-Healthcare.git
cd PI-IR-SOC-Healthcare
```

## 3. Configure Ngrok
You need an Authtoken to use Ngrok.
1. Sign up/Log in at [ngrok.com](https://dashboard.ngrok.com).
2. Go to **Your Authtoken** and copy the token.

## 4. Run the DMZ
Start the Patient Portal and Ngrok services. You **MUST** provide your own Ngrok Authtoken.

```bash
# Replace this with your token from dashboard.ngrok.com
export NGROK_AUTHTOKEN=2p...your_token_here...

# Start the stack
sudo -E docker compose -f docker-compose.dmz.yml up -d --build
```
*(The `-E` flag is crucial: it passes your exported token into the sudo environment)*

## 5. Get Your Public URL
Once running, find the public URL generated by Ngrok:

```bash
sudo docker logs ngrok-dmz
```

Look for the line starting with `url=`.  
Example: `url=https://a1b2c3d4.ngrok-free.app`
*(Note: If you use the free plan, this URL changes every time you restart)*

## 6. Access the Portal
Open that URL in any browser. You should see the Patient Portal.

- **Username**: `patient`
- **Password**: `patient`
